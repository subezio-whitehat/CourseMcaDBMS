CREATE TABLE CUSTOMER
(
CUST_ID INT PRIMARY KEY,
CUST_NAME VARCHAR(25)
);

DESCRIBE CUSTOMER;

CREATE TABLE ITEM
(
ITEM_ID INT PRIMARY KEY,
ITEM_NAME VARCHAR(25),
PRICE INT
);

DESCRIBE ITEM;

CREATE TABLE SALE
(
BILL_NO INT PRIMARY KEY,
BILL_DATE DATE,
CUST_ID INT,
ITEM_ID INT,
QTY_SOLD INT,
CONSTRAINT FK_CUST FOREIGN KEY(CUST_ID) REFERENCES CUSTOMER(CUST_ID),
CONSTRAINT FK_ITEM FOREIGN KEY(ITEM_ID) REFERENCES ITEM(ITEM_ID)
);

DESCRIBE SALE;


INSERT INTO CUSTOMER(CUST_ID,CUST_NAME) VALUES
(1,'REKHA'),
(2,'RANI'),
(3,'ROCKY'),
(4,'XIN'),
(5,'KIM');
SELECT * FROM CUSTOMER;

INSERT INTO ITEM(ITEM_ID,ITEM_NAME,PRICE) VALUES
(1,'RUSK',120),
(2,'BANANA',50),
(3,'SANITIZER',60),
(4,'CAKE',420),
(5,'LADDU',25);
SELECT * FROM ITEM;

INSERT INTO SALE(BILL_NO,BILL_DATE,CUST_ID,ITEM_ID,QTY_SOLD)VALUES
(10,'2020-10-01',1,1,3),
(11,'2020-10-01',1,3,2),
(12,'2020-10-01',1,5,7),
(13,'2018-10-01',4,4,1),
(14,'2018-10-11',4,2,2),
(15,'2018-09-29',5,1,5),
(16,'2019-12-25',3,1,5),
(17,'1995-06-21',5,4,4),
(18,'2002-04-01',4,5,5),
(19,'2020-02-12',1,2,1);
SELECT * FROM SALE;

SELECT * FROM CUSTOMER,ITEM,SALE WHERE ITEM.PRICE>200 AND ITEM.ITEM_ID =SALE.ITEM_ID AND SALE.CUST_ID= CUSTOMER.CUST_ID;
#SELECT * FROM CUSTOMER,ITEM WHERE ITEM.PRICE>200;

SELECT CUSTOMER.CUST_ID,CUST_NAME, COUNT(ITEM_ID) AS NO_OF_ITEMS ,BILL_DATE FROM SALE,CUSTOMER
WHERE SALE.CUST_ID = CUSTOMER.CUST_ID GROUP BY BILL_DATE;

SELECT CUSTOMER.CUST_ID, CUST_NAME, COUNT(ITEM_ID) AS NO_OF_ITEMS, BILL_DATE FROM SALE, CUSTOMER
WHERE SALE.CUST_ID = CUSTOMER.CUST_ID GROUP BY BILL_DATE HAVING EXTRACT(YEAR FROM BILL_DATE)=2018;

SELECT ITEM.ITEM_ID,ITEM_NAME FROM ITEM,SALE WHERE SALE.ITEM_ID = ITEM.ITEM_ID AND SALE.CUST_ID=5;

SELECT ITEM.ITEM_ID, ITEM_NAME FROM ITEM, SALE WHERE ITEM.ITEM_ID=SALE.ITEM_ID AND BILL_DATE=CURDATE();

SELECT ITEM_NAME,QTY_SOLD,PRICE,(QTY_SOLD*PRICE) AS TOTAL_AMOUNT FROM ITEM,CUSTOMER,SALE 
WHERE CUSTOMER.CUST_NAME='REKHA' AND CUSTOMER.CUST_ID=SALE.CUST_ID AND SALE.ITEM_ID=ITEM.ITEM_ID;